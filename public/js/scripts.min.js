$(function(){window.PRODUCTS={};var a=function(){var a=this;this.iframe=$("#print-frame")[0],this.refresh=function(){a.iframe.src=a.iframe.src},this.print=function(){a.iframe.contentWindow.print()}};window.printFrame=new a;var b=function(){this.addItem=function(a){localStorage[a]=!0,window.printFrame.refresh()},this.removeItem=function(a){localStorage[a]=!1,window.printFrame.refresh()},this.clearAll=function(a){a.preventDefault();for(var b in window.PRODUCTS)window.PRODUCTS[b].drop()}};window.BAG=new b;var c=function(a){var b=this;this.container=a,this.trash=this.container.find(".remove"),this.ID=parseInt(this.container.attr("data-pid")),this.active=!1,this.construct=function(){b.container.on("click",b.take),b.trash.on("click",b.drop)},this.take=function(){b.container.addClass("selected"),b.active=!0,BAG.addItem(b.ID)},this.drop=function(){arguments.length&&arguments[0].stopPropagation(),b.container.removeClass("selected"),b.active=!1,BAG.removeItem(b.ID)},this.construct()};if($("[data-pid]").each(function(){var a=$(this),b=parseInt(a.attr("data-pid"));window.PRODUCTS[b]=new c($(this))}),$(".ui-notification").length&&$("#addProductForm [name=name]").focus(),$("#sidebar header .clear-all").on("click",window.BAG.clearAll),$("#sidebar .print a").on("click",function(a){a.preventDefault(),window.printFrame.print()}),localStorage.length){for(var d=[],e=0;e<localStorage.length;e++){var f=parseInt(localStorage.key(e));if(!isNaN(f))if("true"===localStorage[f]){if(!(f in window.PRODUCTS)){d.push(f);continue}window.PRODUCTS[f].take()}else d.push(f)}if(d.length)for(var e=0;e<d.length;e++)localStorage.removeItem(d[e])}});